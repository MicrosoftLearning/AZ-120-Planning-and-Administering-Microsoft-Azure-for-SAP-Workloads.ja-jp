---
lab:
  title: 00 - ラボの前提条件
  module: Module 00 - Lab prerequisites
---

# AZ 120:ラボの前提条件

## vCPU コア要件

> **重要**: vCPU コアの要件は、実装するラボによって異なります。

- 「ラボ 04b - Windows を実行する Azure VM に SAP アーキテクチャを実装する」を完了するには、このラボでデプロイする Azure VM が存在する、可用性ゾーンをサポートする Azure リージョンで少なくとも 28 個の vCPU を利用可能な Microsoft Azure サブスクリプションが必要です。

    - 4 x Standard_DS1_v2 (各 1 vCPU) = 4
    - 6 x Standard_D4s_v3 (各 4 vCPU) = 24

    > **注**:リソースのデプロイには、**米国東部**または**米国東部 2** リージョンの使用を検討してください。

    > **注**:可用性ゾーンをサポートする Azure リージョンを特定するには、「<https://docs.microsoft.com/en-us/azure/availability-zones/az-overview>」を参照してください

- 「ラボ 05 - Azure Center for SAP solutions を使用してデプロイを自動化する」を完了するには、このラボでデプロイする Azure VM が存在する Azure リージョンで、次の vCPU 可用性を備えた Microsoft Azure サブスクリプションが必要です。

    - 4 x Standard_E4ds_v4 (それぞれ 4 個の vCPU) または 4 x Standard_D4ds_v4 (それぞれ 4 個の vCPU) = 8
    - 2 x Standard_M64ms (それぞれ 64 vCPU) = 128

>**注**:vCPU とメモリの要件を最小限に抑えるには、Standard_M64mの代わりに Standard_M32ts (それぞれ 32 個の vCPU と 192 GiB のメモリ) を使用できます。

>**注**:このコースの最初の 3 つのラボの vCPU 要件は低いですが、クォータを増やすプロセスには時間がかかる場合があるため (クォータの増加要求が同じ営業日に完了する場合もあります)、ラボ全体の要件を満たせるようクォータの増加を要求するようお勧めします。

## 実践ラボの前

期間:30 分

### タスク 1:vCPU コアの数がラボ「Windows を実行する Azure VM に SAP アーキテクチャを実装する」用に十分なことを検証する

1. ラボ コンピューターから Web ブラウザーを起動し、`https://portal.azure.com` にある Azure portal に移動します。
1. Azure portal 上の Cloud Shell で PowerShell セッションを開始します。 

    > **注**:現在の Azure サブスクリプションで Cloud Shell を初めて起動する場合は、Azure ファイル共有を作成して Cloud Shell ファイルを永続化するように求められます。 その場合は、既定値に設定すると、自動的に生成されたリソース グループ内にストレージ アカウントが作成されます。

1. Azure portal の **[Cloud Shell]** ペインにある PowerShell プロンプトで、次を実行します。`<Azure_region>` は、このラボで使用する対象の Azure リージョンを指定します (例: `eastus`)。

    ```powershell
    Get-AzVMUsage -Location '<Azure_region>' | Where-Object {$_.Name.Value -eq 'StandardDSv3Family'}

    Get-AzVMUsage -Location '<Azure_region>' | Where-Object {$_.Name.Value -eq 'StandardDSv2Family'}
    ``` 

    > **注**:Azure リージョンの名前を識別するには、**Cloud Shell** の Bash プロンプトで `(Get-AzLocation).Location` を実行します
   
1. 前の手順で実行したコマンドの出力の現在の値と制限エントリを確認し、Azure リージョンに十分な数の vCPU があることを確認します。
1. vCPU の数が十分でない場合は、Azure portal でサブスクリプション ブレードに戻り、**[使用状況 + クォータ]** をクリックします。 
1. サブスクリプションの **[使用状況 + クォータ]** ブレードで、**[増量のリクエスト]** をクリックします。
1. **[問題の説明]** ブレードで、次のように指定します。

    -   問題の種類:**サービスとサブスクリプションの制限 (クォータ)**
    -   サブスクリプション: このラボで使用する Azure サブスクリプションの名前
    -   クォータの種類:**コンピューティング/VM (コア/vCPU) サブスクリプション制限の増加**

1. **[クォータの管理]** をクリックします。
1. [場所] ドロップダウン メニューを使用して、使用する予定の Azure リージョンに結果をフィルター処理します。 **[米国東部]** または **[米国東部 2]** を使用することをお勧めします。
1. **Standard DSv3 Family vCPUs** のクォータの種類を見つけて、[編集] の鉛筆アイコンを選択します。
1. [新しい制限] フィールドで、**40** を指定し、**[保存して続行]** をクリックします。
1. **Total Regional vCPUs** クォータの種類を見つけて、[鉛筆の編集] を選択します。
1. [新しい制限] フィールドで、**40** を指定し、**[保存して続行]** をクリックします。

   > **注**:クォータの引き上げ要求は自動的に承認される必要があります。 要求が拒否された場合は、「サポート チケットを開いてクォータの引き上げを要求する」に進みます。

### タスク 2:vCPU コアの数が「ラボ: Azure Center for SAP solutions を使用してデプロイを自動化する」用に十分なことを検証する

> **注**: (説明されている通りに) このラボを完了するには、以下の VM のデプロイに対応する vCPU クォータを持つ Microsoft Azure サブスクリプションが必要になります。

- ASCS 層用の 2 個の Standard_E4ds_v4 (それぞれ 4 個の vCPU と 32 GiB のメモリ) VM または 2 個の Standard_D4ds_v4 (それぞれ 4 個の vCPU と 16 GiB のメモリ) VM
- アプリケーション層用の 2 個の Standard_E4ds_v4 (それぞれ 4 個の vCPU と 32 GiB のメモリ) VM または 2 個の Standard_D4ds_v4 (それぞれ 4 個の vCPU と 16 GiB のメモリ) VM 
- データベース層用の 2 個の Standard_M64ms (それぞれ 64 個の vCPU と 1750 GiB のメモリ) VM

1. ラボ コンピューターから Web ブラウザーを起動し、`https://portal.azure.com` にある Azure portal に移動します。
1. Azure portal で、 **[Cloud Shell]** アイコンを選択し、Cloud Shell で PowerShell セッションを開始します。 
1. Azure portal の **[Cloud Shell]** ペインの PowerShell プロンプトで、次を実行します: `<Azure_region>` は、このラボのリソースをデプロイする予定である Azure リージョンを指定します (例: `eastus`):

    ```powershell
    Get-AzVMUsage -Location '<Azure_region>' | Where-Object {$_.Name.Value -eq 'standardEDSv4Family'}

    Get-AzVMUsage -Location '<Azure_region>' | Where-Object {$_.Name.Value -eq 'standardDSv4Family'}

    Get-AzVMUsage -Location '<Azure_region>' | Where-Object {$_.Name.Value -eq 'standardMSFamily'}

    Get-AzVMUsage -Location '<Azure_region>' | Where-Object {$_.Name.Value -eq 'cores'}
    ```

    > **注**:Azure リージョンの名前を識別するには、**Cloud Shell** の Bash プロンプトで `(Get-AzLocation).Location` を実行します

1. 出力を確認して、現在の vCPU 使用量と vCPU 制限を特定します。 これらの差が、このラボでデプロイする Azure VM の vCPU を許容するのに十分であることを確認します。 VM ファミリ固有の数とリージョン vCPU の合計数の両方を考慮します。 
1. vCPU の数が不足している場合は、[Cloud Shell] ペインを閉じ、Azure portal の **[検索]** テキスト ボックスで、 **[クォータ]** を検索して選択します。
1. **[クォータ]** ページで、 **[コンピューティング]** を選択します。
1. **[クォータ \| コンピューティング]** ページで、 **[リージョン]** フィルターを使用して、このラボのリソースのデプロイ先とする予定の Azure リージョンを選択します。
1. **[クォータ名]** 列で、クォータの引き上げが必要な VM SKU 名を見つけて選択します。 
1. 同じ行で、 **[調整可能]** 列のエントリを確認します。 次の手順は、列に **[はい]** と **[いいえ]** エントリのどちらが含まれているかによって異なります。

   - エントリが **[はい]** に設定されている場合は、 **[調整の要求]** アイコンを選択し、 **[新しいクォータの要求]** の **[新しい制限]** テキスト ボックスに新しいクォータ制限を入力してから、 **[送信]** を選択します。
   - エントリが **[いいえ]** に設定されている場合は、 **[アクセスの要求または推奨事項の取得]** アイコンを選択し、 **[クォータの推奨事項]** ペインで、 **[サポートに問い合わせる]** オプションを選択してから、 **[次へ]** を選択します。 

1. **[新しいサポートのリクエスト]** ページの **[問題の記述]** タブで、以下の設定を指定してから **[次へ]** を選択します。

    |設定|値|
    |---|---|
    |問題は何に関係していますか?|**Azure サービス**|
    |問題の種類|**サービスとサブスクリプションの制限 (クォータ)**|
    |サブスクリプション|このラボで使用している Azure サブスクリプションの名前|
    |クォータの種類|**コンピューティング/VM (コア/vCPU) サブスクリプション制限の増加**|

1. **[追加の詳細]** タブで、 **[詳細の入力]** を選択します。
1. **[クォータの詳細]** タブの **[デプロイ モデル]** ドロップダウン リストで、 **[リソース マネージャー]** を選択し、 **[場所]** ドロップダウン リストで、ターゲットの Azure リージョンを選択し、 **[クォータ]** ドロップダウン リストで、クォータ制限を引き上げる必要がある Azure VM シリーズを選択し、 **[新しい制限]** テキスト ボックスに新しいクォータ制限を入力してから、 **[保存して続行]** を選択します。
1. **[追加の詳細]** タブに戻り、 **[高度な診断情報]** タブで、 **[はい (推奨)]** を選択します。
1. **[サポート方法]** セクションで、希望する連絡方法として **[メール]** または **[電話]** を選択してから、 **[次へ]** を選択します。
1. **[確認および作成]** タブで、 **[作成]** を選択します。

    > **注**:クォータ制限の引き上げ要求が正常に完了するまで待ってから、ラボ「Azure Center for SAP solutions を使用してデプロイを自動化する」を開始してください。
